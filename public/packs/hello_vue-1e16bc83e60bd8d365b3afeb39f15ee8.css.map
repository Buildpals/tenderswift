{"version":3,"file":"hello_vue-1e16bc83e60bd8d365b3afeb39f15ee8.css","sources":["webpack:///./dropdown.css","webpack:///./form-input.css","webpack:///./table.css","webpack:///./app/javascript/uploadBoq/uploadBoq.vue","webpack:///./app/javascript/uploadBoq/app/javascript/uploadBoq/uploadBoqSheet.vue","webpack:///./app/javascript/rateFillingBoq/rateFillingBoq.vue","webpack:///./app/javascript/rateFillingBoq/app/javascript/rateFillingBoq/rateFillingBoqSheet.vue","webpack:///./app/javascript/viewBidBoq/viewBidBoq.vue","webpack:///./app/javascript/viewBidBoq/app/javascript/viewBidBoq/viewBidBoqSheet.vue","webpack:///./app/javascript/comparisonBoq/comparisonBoq.vue","webpack:///./app/javascript/comparisonBoq/app/javascript/comparisonBoq/comparisonBoqSheet.vue","webpack:///./app/javascript/bidsTable/bidsTable.vue"],"sourcesContent":["/* workaround for https://github.com/bootstrap-vue/bootstrap-vue/issues/1560 */\n/* source: _input-group.scss */\n\n.input-group > .input-group-prepend > .b-dropdown > .btn,\n.input-group > .input-group-append:not(:last-child) > .b-dropdown > .btn,\n.input-group > .input-group-append:last-child > .b-dropdown:not(:last-child):not(.dropdown-toggle) > .btn {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n}\n\n.input-group > .input-group-append > .b-dropdown > .btn,\n.input-group > .input-group-prepend:not(:first-child) > .b-dropdown > .btn,\n.input-group > .input-group-prepend:first-child > .b-dropdown:not(:first-child) > .btn {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./dropdown.css","/* Special styling for type=range and type=color input */\ninput.form-control[type=\"range\"],\ninput.form-control[type=\"color\"] {\n    height: 2.25rem;\n}\ninput.form-control.form-control-sm[type=\"range\"],\ninput.form-control.form-control-sm[type=\"color\"] {\n    height: 1.9375rem;\n}\ninput.form-control.form-control-lg[type=\"range\"],\ninput.form-control.form-control-lg[type=\"color\"] {\n    height: 3rem;\n}\n\n/* Less padding on type=color */\ninput.form-control[type=\"color\"] {\n    padding: 0.25rem 0.25rem;\n}\ninput.form-control.form-control-sm[type=\"color\"] {\n    padding: 0.125rem 0.125rem;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./form-input.css","/* Add support for fixed layout table */\ntable.b-table.b-table-fixed {\n    table-layout: fixed;\n}\n\n/* Busy table styling */\ntable.b-table[aria-busy='false'] {\n    opacity: 1;\n}\ntable.b-table[aria-busy='true'] {\n    opacity: 0.6;\n}\n\n/* Sort styling */\ntable.b-table > thead > tr > th,\ntable.b-table > tfoot > tr > th {\n    position: relative;\n}\ntable.b-table > thead > tr > th.sorting,\ntable.b-table > tfoot > tr > th.sorting {\n    padding-right: 1.5em;\n    cursor: pointer;\n}\ntable.b-table > thead > tr > th.sorting::before,\ntable.b-table > thead > tr > th.sorting::after,\ntable.b-table > tfoot > tr > th.sorting::before,\ntable.b-table > tfoot > tr > th.sorting::after {\n    position: absolute;\n    bottom: 0;\n    display: block;\n    opacity: 0.4;\n    padding-bottom: inherit;\n    font-size: inherit;\n    line-height: 180%;\n}\ntable.b-table > thead > tr > th.sorting::before,\ntable.b-table > tfoot > tr > th.sorting::before {\n    right: 0.75em;\n    content: '\\2191';\n}\ntable.b-table > thead > tr > th.sorting::after,\ntable.b-table > tfoot > tr > th.sorting::after {\n    right: 0.25em;\n    content: '\\2193';\n}\ntable.b-table > thead > tr > th.sorting_asc::after,\ntable.b-table > thead > tr > th.sorting_desc::before,\ntable.b-table > tfoot > tr > th.sorting_asc::after,\ntable.b-table > tfoot > tr > th.sorting_desc::before {\n    opacity: 1;\n}\n\n/* Stacked table layout */\n/* Derived from http://blog.adrianroselli.com/2017/11/a-responsive-accessible-table.html */\n/* Always stacked */\ntable.b-table.b-table-stacked {\n    width: 100%;\n}\ntable.b-table.b-table-stacked,\ntable.b-table.b-table-stacked > tbody,\ntable.b-table.b-table-stacked > tbody > tr,\ntable.b-table.b-table-stacked > tbody > tr > td,\ntable.b-table.b-table-stacked > tbody > tr > th,\ntable.b-table.b-table-stacked > caption {\n    display: block;\n}\n\n/* Hide stuff we can't deal with, or shouldn't show */\ntable.b-table.b-table-stacked > thead,\ntable.b-table.b-table-stacked > tfoot,\ntable.b-table.b-table-stacked > tbody > tr.b-table-top-row,\ntable.b-table.b-table-stacked > tbody > tr.b-table-bottom-row {\n    display: none;\n}\n\n/* inter-row top border */\ntable.b-table.b-table-stacked > tbody > tr > :first-child {\n    border-top-width: 0.4rem;\n}\n\n/* convert TD/TH contents to \"cells\". Caveat: child elements become cells! */\ntable.b-table.b-table-stacked > tbody > tr > [data-label] {\n    display: grid;\n    grid-template-columns: 40% auto;\n    grid-gap: 0.25rem 1rem;\n}\n\n/* generate row cell \"heading\" */\ntable.b-table.b-table-stacked > tbody > tr > [data-label]::before {\n    content: attr(data-label);\n    display: inline;\n    text-align: right;\n    overflow-wrap: break-word;\n    font-weight: bold;\n    font-style: normal;\n}\n\n@media all and (max-width: 575.99px) {\n    /* Under SM */\n    table.b-table.b-table-stacked-sm {\n        width: 100%;\n    }\n    table.b-table.b-table-stacked-sm,\n    table.b-table.b-table-stacked-sm > tbody,\n    table.b-table.b-table-stacked-sm > tbody > tr,\n    table.b-table.b-table-stacked-sm > tbody > tr > td,\n    table.b-table.b-table-stacked-sm > tbody > tr > th,\n    table.b-table.b-table-stacked-sm > caption {\n        display: block;\n    }\n    /* hide stuff we can't deal with, or shouldn't show */\n    table.b-table.b-table-stacked-sm > thead,\n    table.b-table.b-table-stacked-sm > tfoot,\n    table.b-table.b-table-stacked-sm > tbody > tr.b-table-top-row,\n    table.b-table.b-table-stacked-sm > tbody > tr.b-table-bottom-row {\n        display: none;\n    }\n    /* inter-row top border */\n    table.b-table.b-table-stacked-sm > tbody > tr > :first-child {\n        border-top-width: 0.4rem;\n    }\n    /* convert TD/TH contents to \"cells\". Caveat: child elements become cells! */\n    table.b-table.b-table-stacked-sm > tbody > tr > [data-label] {\n        display: grid;\n        grid-template-columns: 40% auto;\n        grid-gap: 0.25rem 1rem;\n    }\n    /* generate row cell \"heading\" */\n    table.b-table.b-table-stacked-sm > tbody > tr > [data-label]::before {\n        content: attr(data-label);\n        display: inline;\n        text-align: right;\n        overflow-wrap: break-word;\n        font-weight: bold;\n        font-style: normal;\n    }\n}\n\n@media all and (max-width: 767.99px) {\n    /* under MD  */\n    table.b-table.b-table-stacked-md {\n        width: 100%;\n    }\n    table.b-table.b-table-stacked-md,\n    table.b-table.b-table-stacked-md > tbody,\n    table.b-table.b-table-stacked-md > tbody > tr,\n    table.b-table.b-table-stacked-md > tbody > tr > td,\n    table.b-table.b-table-stacked-md > tbody > tr > th,\n    table.b-table.b-table-stacked-md > caption {\n        display: block;\n    }\n    /* hide stuff we can't deal with, or shouldn't show */\n    table.b-table.b-table-stacked-md > thead,\n    table.b-table.b-table-stacked-md > tfoot,\n    table.b-table.b-table-stacked-md > tbody > tr.b-table-top-row,\n    table.b-table.b-table-stacked-md > tbody > tr.b-table-bottom-row {\n        display: none;\n    }\n    /* inter-row top border */\n    table.b-table.b-table-stacked-md > tbody > tr > :first-child {\n        border-top-width: 0.4rem;\n    }\n    /* convert TD/TH contents to \"cells\". Caveat: child elements become cells! */\n    table.b-table.b-table-stacked-md > tbody > tr > [data-label] {\n        display: grid;\n        grid-template-columns: 40% auto;\n        grid-gap: 0.25rem 1rem;\n    }\n    /* generate row cell \"heading\" */\n    table.b-table.b-table-stacked-md > tbody > tr > [data-label]::before {\n        content: attr(data-label);\n        display: inline;\n        text-align: right;\n        overflow-wrap: break-word;\n        font-weight: bold;\n        font-style: normal;\n    }\n}\n\n@media all and (max-width: 991.99px) {\n    /* under LG  */\n    table.b-table.b-table-stacked-lg {\n        width: 100%;\n    }\n    table.b-table.b-table-stacked-lg,\n    table.b-table.b-table-stacked-lg > tbody,\n    table.b-table.b-table-stacked-lg > tbody > tr,\n    table.b-table.b-table-stacked-lg > tbody > tr > td,\n    table.b-table.b-table-stacked-lg > tbody > tr > th,\n    table.b-table.b-table-stacked-lg > caption {\n        display: block;\n    }\n    /* hide stuff we can't deal with, or shouldn't show */\n    table.b-table.b-table-stacked-lg > thead,\n    table.b-table.b-table-stacked-lg > tfoot,\n    table.b-table.b-table-stacked-lg > tbody > tr.b-table-top-row,\n    table.b-table.b-table-stacked-lg > tbody > tr.b-table-bottom-row {\n        display: none;\n    }\n    /* inter-row top border */\n    table.b-table.b-table-stacked-lg > tbody > tr > :first-child {\n        border-top-width: 0.4rem;\n    }\n    /* convert TD/TH contents to \"cells\". Caveat: child elements become cells! */\n    table.b-table.b-table-stacked-lg > tbody > tr > [data-label] {\n        display: grid;\n        grid-template-columns: 40% auto;\n        grid-gap: 0.25rem 1rem;\n    }\n    /* generate row cell \"heading\" */\n    table.b-table.b-table-stacked-lg > tbody > tr > [data-label]::before {\n        content: attr(data-label);\n        display: inline;\n        text-align: right;\n        overflow-wrap: break-word;\n        font-weight: bold;\n        font-style: normal;\n    }\n}\n\n@media all and (max-width: 1199.99px) {\n    /* under XL  */\n    table.b-table.b-table-stacked-xl {\n        width: 100%;\n    }\n    table.b-table.b-table-stacked-xl,\n    table.b-table.b-table-stacked-xl > tbody,\n    table.b-table.b-table-stacked-xl > tbody > tr,\n    table.b-table.b-table-stacked-xl > tbody > tr > td,\n    table.b-table.b-table-stacked-xl > tbody > tr > th,\n    table.b-table.b-table-stacked-xl > caption {\n        display: block;\n    }\n    /* hide stuff we can't deal with, or shouldn't show */\n    table.b-table.b-table-stacked-xl > thead,\n    table.b-table.b-table-stacked-xl > tfoot,\n    table.b-table.b-table-stacked-xl > tbody > tr.b-table-top-row,\n    table.b-table.b-table-stacked-xl > tbody > tr.b-table-bottom-row {\n        display: none;\n    }\n    /* inter-row top border */\n    table.b-table.b-table-stacked-xl > tbody > tr > :first-child {\n        border-top-width: 0.4rem;\n    }\n    /* convert TD/TH contents to \"cells\". Caveat: child elements become cells! */\n    table.b-table.b-table-stacked-xl > tbody > tr > [data-label] {\n        display: grid;\n        grid-template-columns: 40% auto;\n        grid-gap: 0.25rem 1rem;\n    }\n    /* generate row cell \"heading\" */\n    table.b-table.b-table-stacked-xl > tbody > tr > [data-label]::before {\n        content: attr(data-label);\n        display: inline;\n        text-align: right;\n        overflow-wrap: break-word;\n        font-weight: bold;\n        font-style: normal;\n    }\n}\n\n/* Details row styling */\ntable.b-table > tbody > tr.b-table-details > td {\n    border-top: none;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./table.css",".spreadsheet-tabs .nav-tabs {\n  /*border-bottom: 1px solid #dee2e6;*/\n  /*border-top: 1px solid #dee2e6;*/\n  border: 1px solid #dee2e6;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  padding-bottom: 0.2rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-item {\n  margin-top: -1px; }\n\n.spreadsheet-tabs .nav-tabs .nav-link {\n  border: 1px solid transparent;\n  border-top-left-radius: initial;\n  border-top-right-radius: initial;\n  border-bottom-left-radius: 0.15rem;\n  border-bottom-right-radius: 0.15rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-link:hover, .spreadsheet-tabs .nav-tabs .nav-link:focus {\n  border-color: #e9ecef #e9ecef #dee2e6; }\n\n.spreadsheet-tabs .nav-tabs .nav-link.active,\n.spreadsheet-tabs .nav-tabs .nav-item.show .nav-link {\n  color: #495057;\n  background-color: #fff;\n  border-color: #fff #dee2e6 #dee2e6; }\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/uploadBoq/uploadBoq.vue","<template>\r\n  <div>\r\n    <div class=\"w-100 d-flex justify-content-start\">\r\n      <div class=\"formula-bar formula-bar-address\">{{ selectedCellAddress }}</div>\r\n      <div class=\"formula-bar formula-bar-icon px-3\">fx</div>\r\n      <div class=\"formula-bar formula-bar-contents\">{{ selectedCellContents }}</div>\r\n    </div>\r\n    <div ref=\"hot\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import Handsontable from 'handsontable';\r\n  import {\r\n    rowHeaderRenderer,\r\n    descriptionRenderer,\r\n    itemRenderer,\r\n    isHeader,\r\n    process_wb\r\n  } from '../renderers'\r\n\r\n  export default {\r\n    props: [\r\n      'workbook',\r\n      'sheetIndex',\r\n      'currency',\r\n      'boqContractSum'\r\n    ],\r\n    mounted () {\r\n      this.initTable()\r\n    },\r\n    beforeDestroy () {\r\n      this.table.destroy()\r\n    },\r\n    watch: {\r\n      'workbook': 'updateTable'\r\n    },\r\n    data () {\r\n      return {\r\n        selectedCellAddress: \"\",\r\n        selectedCellContents: \"\",\r\n        dataSchema: {\r\n          'item': null,\r\n          'description': null,\r\n          'quantity': null,\r\n          'unit': null,\r\n          'rate': null,\r\n          'amount': null,\r\n          'last': null\r\n        },\r\n        columns: [\r\n          {\r\n            data: 'item',\r\n            renderer: itemRenderer\r\n          },\r\n          {\r\n            data: 'description',\r\n            className: 'htLeft'\r\n          },\r\n          {\r\n            data: 'quantity',\r\n            type: 'numeric'\r\n          },\r\n          {\r\n            data: 'unit',\r\n            renderer: itemRenderer\r\n          },\r\n          {\r\n            data: 'rate',\r\n            type: 'numeric',\r\n            numericFormat: {\r\n              pattern: '0,0.00',\r\n              culture: 'en-US'\r\n            },\r\n            allowEmpty: false\r\n          },\r\n          {\r\n            data: 'amount',\r\n            type: 'numeric',\r\n            numericFormat: {\r\n              pattern: '0,0.00',\r\n              culture: 'en-US'\r\n            },\r\n            allowEmpty: false\r\n          },\r\n          {\r\n            data: 'last'\r\n          }\r\n        ],\r\n        height: window.innerHeight - (42 + 85 + 78),\r\n        mergeCells: []\r\n      }\r\n    },\r\n    computed: {\r\n      sheetData () {\r\n        return process_wb(this.workbook, this.sheetIndex)\r\n      }\r\n    },\r\n    methods: {\r\n      initTable () {\r\n        let self = this\r\n        this.table = new Handsontable(this.$refs.hot, {\r\n          data: this.sheetData,\r\n          dataSchema: this.dataSchema,\r\n          columns: this.columns,\r\n          cells: this.cells,\r\n          mergeCells: this.mergeCells,\r\n          startRows: 100,\r\n          colHeaders: true,\r\n          rowHeaders: true,\r\n          minSpareRows: 1,\r\n          height: this.height,\r\n          stretchH: 'last',\r\n          colWidths: this.colWidths,\r\n          readOnly: true,\r\n          afterSelection: function (r, c, r2, c2, preventScrolling, selectionLayerLevel) {\r\n            let columnLetter = String.fromCharCode(65 + c)\r\n            let cellAddress = `${columnLetter}${ r + 1 }`\r\n            self.selectedCellAddress = cellAddress\r\n\r\n            let sheet = self.workbook.SheetNames[self.sheetIndex]\r\n            let formula = self.workbook.Sheets[sheet][cellAddress].f\r\n            let value = self.workbook.Sheets[sheet][cellAddress].v\r\n            if (formula) {\r\n              self.selectedCellContents = formula\r\n            } else {\r\n              self.selectedCellContents = value\r\n            }\r\n          },\r\n          contextMenu: {\r\n            callback: function (key, options) {\r\n              if (key === 'set_contract_sum_address') {\r\n                let option = options[0]\r\n                if (option.start.row === option.end.row && option.start.col === option.end.col) {\r\n                  let sheet = self.workbook.SheetNames[self.sheetIndex]\r\n                  self.$emit('setContractSumAddress', sheet, option.start.row, option.start.col)\r\n                } else {\r\n                  setTimeout(function () {\r\n                    // timeout is used to make sure the menu collapsed before alert is shown\r\n                    alert(\"Tender figure should only be found in one cell\");\r\n                  }, 100);\r\n                }\r\n              }\r\n            },\r\n            items: {\r\n              \"set_contract_sum_address\": {name: 'Set as tender figure'}\r\n            }\r\n          }\r\n        })\r\n      },\r\n      updateTable () {\r\n        this.table.updateSettings({data: this.sheetData})\r\n      },\r\n      cells (row, col, prop) {\r\n        const cellProperties = {}\r\n\r\n        if (row === 0) {\r\n          cellProperties.renderer = rowHeaderRenderer\r\n        } else if (row > 0 && col === 1) {\r\n          cellProperties.renderer = descriptionRenderer\r\n        }\r\n\r\n        return cellProperties\r\n      },\r\n      colWidths (index) {\r\n        if (index === 0) {\r\n          return 60\r\n        } else if (index === 1) {\r\n          return 550\r\n        } else if (index === 2) {\r\n          return 60\r\n        } else if (index === 3) {\r\n          return 60\r\n        } else {\r\n          return 100\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  /* @import \"handsontable/dist/handsontable.full.css\"; */\r\n\r\n  #test-hot {\r\n    overflow: hidden;\r\n  }\r\n\r\n  .formula-bar {\r\n    box-sizing: content-box;\r\n    -webkit-box-sizing: content-box;\r\n    -moz-box-sizing: content-box;\r\n\r\n    border-right: 1px solid #CCC;\r\n    border-top: 1px solid #CCC;\r\n    border-left: 1px solid #CCC;\r\n    height: 22px;\r\n    empty-cells: show;\r\n    line-height: 21px;\r\n    padding: 0 4px 0 4px;\r\n    background-color: #FFF;\r\n    vertical-align: top;\r\n    overflow: hidden;\r\n    outline-width: 0;\r\n    white-space: pre-line;\r\n    background-clip: padding-box;\r\n\r\n    color: #777;\r\n  }\r\n\r\n  .formula-bar-address {\r\n    width: 80px;\r\n  }\r\n\r\n  .formula-bar-icon {\r\n    background-color: transparent;\r\n    border-right: transparent;\r\n    border-left: transparent;\r\n  }\r\n\r\n  .formula-bar-contents {\r\n    flex: 1 0 auto;\r\n  }\r\n</style>\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/uploadBoq/app/javascript/uploadBoq/uploadBoqSheet.vue",".spreadsheet-tabs .nav-tabs {\n  /*border-bottom: 1px solid #dee2e6;*/\n  /*border-top: 1px solid #dee2e6;*/\n  border: 1px solid #dee2e6;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  padding-bottom: 0.2rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-item {\n  margin-top: -1px; }\n\n.spreadsheet-tabs .nav-tabs .nav-link {\n  border: 1px solid transparent;\n  border-top-left-radius: initial;\n  border-top-right-radius: initial;\n  border-bottom-left-radius: 0.15rem;\n  border-bottom-right-radius: 0.15rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-link:hover, .spreadsheet-tabs .nav-tabs .nav-link:focus {\n  border-color: #e9ecef #e9ecef #dee2e6; }\n\n.spreadsheet-tabs .nav-tabs .nav-link.active,\n.spreadsheet-tabs .nav-tabs .nav-item.show .nav-link {\n  color: #495057;\n  background-color: #fff;\n  border-color: #fff #dee2e6 #dee2e6; }\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/rateFillingBoq/rateFillingBoq.vue","<template>\n  <div>\n    <div id=\"hot\"></div>\n  </div>\n</template>\n\n<script>\n  import Handsontable from 'handsontable';\n  import {\n    rowHeaderRenderer,\n    descriptionRenderer,\n    itemRenderer,\n    isHeader,\n    process_wb\n  } from '../renderers'\n\n  export default {\n    props: [\n      'workbook',\n      'sheetIndex',\n      'currency',\n      'boqContractSum'\n    ],\n    mounted () {\n      this.initTable()\n    },\n    beforeDestroy () {\n      this.table.destroy()\n    },\n    watch: {\n      'workbook': 'updateTable'\n    },\n    data () {\n      return {\n        dataSchema: {\n          'item': null,\n          'description': null,\n          'quantity': null,\n          'unit': null,\n          'rate': null,\n          'amount': null,\n          'last': null\n        },\n        columns: [\n          {\n            data: 'item',\n            renderer: itemRenderer\n          },\n          {\n            data: 'description',\n            className: 'htLeft'\n          },\n          {\n            data: 'quantity',\n            type: 'numeric'\n          },\n          {\n            data: 'unit',\n            renderer: itemRenderer\n          },\n          {\n            data: 'rate',\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            allowEmpty: false,\n            readOnly: false\n          },\n          {\n            data: 'amount',\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            allowEmpty: false\n          },\n          {\n            data: 'last'\n          }\n        ],\n        height: window.innerHeight - (42 + 120),\n        mergeCells: []\n      }\n    },\n    computed: {\n      sheetData () {\n        return process_wb(this.workbook, this.sheetIndex)\n      }\n    },\n    methods: {\n      initTable () {\n        this.table = new Handsontable(this.$el, {\n          data: this.sheetData,\n          dataSchema: this.dataSchema,\n          columns: this.columns,\n          cells: this.cells,\n          mergeCells: this.mergeCells,\n          startRows: 100,\n          colHeaders: true,\n          rowHeaders: true,\n          minSpareRows: 1,\n          height: this.height,\n          stretchH: 'last',\n          colWidths: this.colWidths,\n          readOnly: true,\n          afterChange: this.afterChange\n        })\n      },\n      updateTable () {\n        this.table.updateSettings({data: this.sheetData})\n      },\n      cells (row, col, prop) {\n        const cellProperties = {}\n\n        if (row === 0) {\n          cellProperties.renderer = rowHeaderRenderer\n        } else if (row > 0 && col === 1) {\n          cellProperties.renderer = descriptionRenderer\n        }\n\n        return cellProperties\n      },\n      colWidths (index) {\n        if (index === 0) {\n          return 60\n        } else if (index === 1) {\n          return 550\n        } else if (index === 2) {\n          return 60\n        } else if (index === 3) {\n          return 60\n        } else {\n          return 100\n        }\n      },\n      afterChange (changes, source) {\n        if (source === 'loadData') return\n\n        changes.forEach((change) => {\n          let sheet = this.workbook.SheetNames[this.sheetIndex]\n          let row = change[0]\n          let col = change[1]\n          let oldVal = change[2]\n          let newVal = change[3]\n\n          this.$emit('edit', sheet, row, col, oldVal, newVal)\n        })\n\n      }\n    }\n  }\n</script>\n\n<style>\n  /* @import \"handsontable/dist/handsontable.full.css\"; */\n\n  #test-hot {\n    overflow: hidden;\n  }\n</style>\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/rateFillingBoq/app/javascript/rateFillingBoq/rateFillingBoqSheet.vue",".spreadsheet-tabs .nav-tabs {\n  /*border-bottom: 1px solid #dee2e6;*/\n  /*border-top: 1px solid #dee2e6;*/\n  border: 1px solid #dee2e6;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  padding-bottom: 0.2rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-item {\n  margin-top: -1px; }\n\n.spreadsheet-tabs .nav-tabs .nav-link {\n  border: 1px solid transparent;\n  border-top-left-radius: initial;\n  border-top-right-radius: initial;\n  border-bottom-left-radius: 0.15rem;\n  border-bottom-right-radius: 0.15rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-link:hover, .spreadsheet-tabs .nav-tabs .nav-link:focus {\n  border-color: #e9ecef #e9ecef #dee2e6; }\n\n.spreadsheet-tabs .nav-tabs .nav-link.active,\n.spreadsheet-tabs .nav-tabs .nav-item.show .nav-link {\n  color: #495057;\n  background-color: #fff;\n  border-color: #fff #dee2e6 #dee2e6; }\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/viewBidBoq/viewBidBoq.vue","<template>\n  <div>\n    <div id=\"hot\"></div>\n  </div>\n</template>\n\n<script>\n  import Handsontable from 'handsontable';\n  import {\n    rowHeaderRenderer,\n    descriptionRenderer,\n    itemRenderer,\n    isHeader,\n    process_wb\n  } from '../renderers'\n\n  export default {\n    props: [\n      'workbook',\n      'sheetIndex',\n      'currency',\n      'boqContractSum'\n    ],\n    mounted () {\n      this.initTable()\n    },\n    beforeDestroy () {\n      this.table.destroy()\n    },\n    watch: {\n      'workbook': 'updateTable'\n    },\n    data () {\n      return {\n        dataSchema: {\n          'item': null,\n          'description': null,\n          'quantity': null,\n          'unit': null,\n          'rate': null,\n          'amount': null,\n          'last': null\n        },\n        columns: [\n          {\n            data: 'item',\n            renderer: itemRenderer\n          },\n          {\n            data: 'description',\n            className: 'htLeft'\n          },\n          {\n            data: 'quantity',\n            type: 'numeric'\n          },\n          {\n            data: 'unit',\n            renderer: itemRenderer\n          },\n          {\n            data: 'rate',\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            allowEmpty: false\n          },\n          {\n            data: 'amount',\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            allowEmpty: false\n          },\n          {\n            data: 'last'\n          }\n        ],\n        height: window.innerHeight - (42 + 190),\n        mergeCells: []\n      }\n    },\n    computed: {\n      sheetData () {\n        return process_wb(this.workbook, this.sheetIndex)\n      }\n    },\n    methods: {\n      initTable () {\n        this.table = new Handsontable(this.$el, {\n          data: this.sheetData,\n          dataSchema: this.dataSchema,\n          columns: this.columns,\n          cells: this.cells,\n          mergeCells: this.mergeCells,\n          startRows: 100,\n          colHeaders: true,\n          rowHeaders: true,\n          minSpareRows: 1,\n          height: this.height,\n          stretchH: 'last',\n          colWidths: this.colWidths,\n          readOnly: true\n        })\n      },\n      updateTable () {\n        this.table.updateSettings({data: this.sheetData})\n      },\n      cells (row, col, prop) {\n        const cellProperties = {}\n\n        if (row === 0) {\n          cellProperties.renderer = rowHeaderRenderer\n        } else if (row > 0 && col === 1) {\n          cellProperties.renderer = descriptionRenderer\n        }\n\n        return cellProperties\n      },\n      colWidths (index) {\n        if (index === 0) {\n          return 60\n        } else if (index === 1) {\n          return 550\n        } else if (index === 2) {\n          return 60\n        } else if (index === 3) {\n          return 60\n        } else {\n          return 100\n        }\n      }\n    }\n  }\n</script>\n\n<style>\n  /* @import \"handsontable/dist/handsontable.full.css\"; */\n\n  #test-hot {\n    overflow: hidden;\n  }\n</style>\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/viewBidBoq/app/javascript/viewBidBoq/viewBidBoqSheet.vue",".spreadsheet-tabs .nav-tabs {\n  /*border-bottom: 1px solid #dee2e6;*/\n  /*border-top: 1px solid #dee2e6;*/\n  border: 1px solid #dee2e6;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  padding-bottom: 0.2rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-item {\n  margin-top: -1px; }\n\n.spreadsheet-tabs .nav-tabs .nav-link {\n  border: 1px solid transparent;\n  border-top-left-radius: initial;\n  border-top-right-radius: initial;\n  border-bottom-left-radius: 0.15rem;\n  border-bottom-right-radius: 0.15rem; }\n\n.spreadsheet-tabs .nav-tabs .nav-link:hover, .spreadsheet-tabs .nav-tabs .nav-link:focus {\n  border-color: #e9ecef #e9ecef #dee2e6; }\n\n.spreadsheet-tabs .nav-tabs .nav-link.active,\n.spreadsheet-tabs .nav-tabs .nav-item.show .nav-link {\n  color: #495057;\n  background-color: #fff;\n  border-color: #fff #dee2e6 #dee2e6; }\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/comparisonBoq/comparisonBoq.vue","<template>\n  <div>\n    <div class=\"w-100 d-flex justify-content-start\">\n      <div class=\"formula-bar formula-bar-address\">{{ selectedCellAddress }}</div>\n      <div class=\"formula-bar formula-bar-icon px-3\">fx</div>\n      <div class=\"formula-bar formula-bar-contents\">{{ selectedCellContents }}</div>\n    </div>\n    <div ref=\"hot\"></div>\n  </div>\n</template>\n\n<script>\n  import Handsontable from 'handsontable';\n  import {\n    rowHeaderRenderer,\n    descriptionRenderer,\n    itemRenderer,\n    isHeader,\n    differenceValueRenderer,\n    process_wb_comparison\n  } from '../renderers'\n\n  export default {\n    props: [\n      'tenders',\n      'workbook',\n      'sheetIndex',\n      'currency',\n      'boqContractSum'\n    ],\n    mounted () {\n      this.initTable()\n    },\n    beforeDestroy () {\n      this.table.destroy()\n    },\n    watch: {\n      'workbook': 'updateTable'\n    },\n    data () {\n      return {\n        selectedCellAddress: \"\",\n        selectedCellContents: \"\",\n        height: window.innerHeight - (42 + 85 + 78),\n        mergeCells: []\n      }\n    },\n    computed: {\n      dataSchema () {\n        let tenderKeys = {}\n        this.tenders.forEach(tender => {\n          let amountKey = `amount (${tender.contractor.company_name})`\n          tenderKeys[amountKey] = null\n        })\n        return {\n          'item': null,\n          'description': null,\n          'quantity': null,\n          'unit': null,\n          'amount': null,\n          ...tenderKeys,\n          'last': null\n        }\n      },\n      columns () {\n        let tenderKeys = []\n        this.tenders.forEach(tender => {\n          let amountKey = `amount (${tender.contractor.company_name})`\n          tenderKeys.push({\n            data: amountKey,\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            renderer: differenceValueRenderer,\n            allowEmpty: false\n          })\n        })\n        console.log(tenderKeys[0].data)\n        return [\n          {\n            data: 'item',\n            renderer: itemRenderer\n          },\n          {\n            data: 'description',\n            className: 'htLeft'\n          },\n          {\n            data: 'quantity',\n            type: 'numeric'\n          },\n          {\n            data: 'unit',\n            renderer: itemRenderer\n          },\n          {\n            data: 'amount',\n            type: 'numeric',\n            numericFormat: {\n              pattern: '0,0.00',\n              culture: 'en-US'\n            },\n            allowEmpty: false\n          },\n          ...tenderKeys,\n          {\n            data: 'last'\n          }\n        ]\n      },\n      sheetData () {\n        return process_wb_comparison(this.workbook, this.sheetIndex, this.tenders)\n      }\n    },\n    methods: {\n      initTable () {\n        let self = this\n        this.table = new Handsontable(this.$refs.hot, {\n          data: this.sheetData,\n          dataSchema: this.dataSchema,\n          columns: this.columns,\n          cells: this.cells,\n          mergeCells: this.mergeCells,\n          startRows: 100,\n          colHeaders: true,\n          rowHeaders: true,\n          minSpareRows: 1,\n          height: this.height,\n          stretchH: 'last',\n          colWidths: this.colWidths,\n          readOnly: true,\n          afterSelection: function (r, c, r2, c2, preventScrolling, selectionLayerLevel) {\n            let columnLetter, cellAddress\n            if(c > 3) {\n              columnLetter = String.fromCharCode(65 + c)\n              cellAddress = `${columnLetter}${ r + 1 }`\n            } else {\n              columnLetter = String.fromCharCode(65 + c)\n              cellAddress = `${columnLetter}${ r + 1 }`\n            }\n\n            self.selectedCellAddress = cellAddress\n\n            let sheet = self.workbook.SheetNames[self.sheetIndex]\n            let formula = self.workbook.Sheets[sheet][cellAddress].f\n            let value = self.workbook.Sheets[sheet][cellAddress].v\n            if (formula) {\n              self.selectedCellContents = formula\n            } else {\n              self.selectedCellContents = value\n            }\n          }\n        })\n      },\n      updateTable () {\n        this.table.updateSettings({data: this.sheetData})\n      },\n      cells (row, col, prop) {\n        const cellProperties = {}\n\n        if (row === 0) {\n          cellProperties.renderer = rowHeaderRenderer\n        } else if (row > 0 && col === 1) {\n          cellProperties.renderer = descriptionRenderer\n        }\n\n        return cellProperties\n      },\n      colWidths (index) {\n        if (index === 0) {\n          return 60\n        } else if (index === 1) {\n          return 550\n        } else if (index === 2) {\n          return 60\n        } else if (index === 3) {\n          return 60\n        } else {\n          return 100\n        }\n      }\n    }\n  }\n</script>\n\n<style>\n  /* @import \"handsontable/dist/handsontable.full.css\"; */\n\n  #test-hot {\n    overflow: hidden;\n  }\n</style>\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/comparisonBoq/app/javascript/comparisonBoq/comparisonBoqSheet.vue","#bids-table {\n  font-size: 0.875rem; }\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/bidsTable/bidsTable.vue"],"mappings":"AAAA;AACA;AAEA;;;AAGA;AACA;AACA;AAEA;;;AAGA;AACA;AACA;ACfA;AACA;;AAEA;AAAA;AACA;AACA;;AAEA;AAAA;AACA;AACA;;AAEA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;ACpBA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AAEA;AACA;;;;AAIA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;ACxQA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;;AAEA;AACA;AACA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6JA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;;AC9NA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;;AAEA;AACA;AACA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoIA;AAEA;AACA;AACA;;ACjKA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;;AAEA;AACA;AACA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoHA;AAEA;AACA;AACA;;ACjJA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;;AAEA;AACA;AACA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmKA;AAEA;AACA;AACA;;AChMA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","sourceRoot":""}