<div class="container">
  <div class="row">
    <div class="col-lg-12 mx-auto">
      <div class="tab-content mt-4">

        <% if @participant.status.in? %w(participating bid_made guest) %>

          <div class="card mb-4">
            <div class="card-header">
              Requirements
            </div>
            <% @participant.request_for_tender.questions.each do |question| %>
              <div class="card-body">

                <%= question.title %>
                <p class="text-muted small"><%= question.description %></p>

                <%= form_with(model: @participant.answer_box_for(question), local: true) do |form| %>
                  <%= form.hidden_field :participant_id, value: @participant.id %>
                  <%= form.hidden_field :question_id, value: question.id %>
                  <%= form.text_field :answer, id: :answer_answer, class: 'form-control form-control-sm mb-2' %>
                  <div class="nested-forms mb-5">
                    <%= form.fields_for :answer_documents do |answer_document| %>
                      <%= render 'answer_document_fields', f: answer_document %>
                    <% end %>
                    <div class="d-flex w-100 justify-content-between mt-3">
                      <%= link_to_add_association 'Add document', form, :answer_documents, class: 'btn btn-sm btn-primary' %>
                      <%= form.submit 'Save', class: 'btn btn-sm btn-primary' %>
                    </div>
                  </div>
                <% end %>
              </div>
            <% end %>
          </div>

        <% end %>

        <%= form_with model: @require_document_upload,
                      scope: :require_document_upload,
                      url: upload_required_documents_path(@participant),
                      method: :post,
                      local: true,
                      id: 'required-document-upload-form' do |form| %>

        <div class="card-body">
          <table class="table">
            <tbody>
            <% @request.required_documents.each do |required_document| %>
              <%= form.fields_for :required_document_uploads do |required| %>
              <tr>
                  <th scope="row"><%= required_document.title %></th>
                  <td><%= link_to 'View', '' %></td>
                  <td>
                      <%= required.text_field :required_document_id, value: required_document.id, type: 'hidden' %>
                      <%= required.file_field :document, class: 'form-control-file form-control-sm mb-2', data: { 'save-on-change': true } %>
                  </td>
              </tr>
              <% end %>
            <% end %>
            <%= form.submit 'Save' %>

            <% end %>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>
</div>