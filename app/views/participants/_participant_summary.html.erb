<div class="card mb-4">
  <div class="card-header">
    <%= @participant.project_name %>
  </div>
  <ul class="list-group list-group-flush">
    <div class="card-body">
      <div class="d-flex w-100 justify-content-between">
        <div>
          <h4 class="card-title">
            <%= @participant.company_name %>
          </h4>
          <p class="mb-1">
            <%= @participant.email %> (<%= @participant.phone_number %>)
          </p>
        </div>
        <h4>
          <small>Total bid:</small>
          <%= humanized_money_with_symbol @participant.bid %>
        </h4>
      </div>

      <div class="col-sm-12 d-flex w-100 mt-3">
        <%= form_with(model: @participant, local: true, id: 'participant-form', class: 'ml-auto') do |form| %>
            <input type="hidden" name="commit" value="save_rating">

            <div class="btn-group" data-toggle="buttons">
              <% if @participant.rating == -1 %>
                  <label class="btn btn-success">
                    <%= form.radio_button :rating, '0', {id: 'rating_remove', autocomplete: 'off'} %>
                    Add
                  </label>
              <% else %>
                  <label class="btn btn-danger">
                    <%= form.radio_button :rating, '-1', {id: 'rating_remove', autocomplete: 'off'} %>
                    Remove
                  </label>
              <% end %>
              <label class="btn btn-light">
                <%= form.radio_button :rating, '1', {id: 'rating1', autocomplete: 'off'} %>
                <span class="fa fa-star text-secondary <%= 'text-warning' if @participant.rating >= 1 %>"></span>
              </label>
              <label class="btn btn-light">
                <%= form.radio_button :rating, '2', {id: 'rating2', autocomplete: 'off'} %>
                <span class="fa fa-star text-secondary <%= 'text-warning' if @participant.rating >= 2 %>"></span>
              </label>
              <label class="btn btn-light">
                <%= form.radio_button :rating, '3', {id: 'rating3', autocomplete: 'off'} %>
                <span class="fa fa-star text-secondary <%= 'text-warning' if @participant.rating >= 3 %>"></span>
              </label>
              <label class="btn btn-light">
                <%= form.radio_button :rating, '4', {id: 'rating4', autocomplete: 'off'} %>
                <span class="fa fa-star text-secondary <%= 'text-warning' if @participant.rating >= 4 %>"></span>
              </label>
              <label class="btn btn-light">
                <%= form.radio_button :rating, '5', {id: 'rating5', autocomplete: 'off'} %>
                <span class="fa fa-star text-secondary <%= 'text-warning' if @participant.rating >= 5 %>"></span>
              </label>
            </div>
        <% end %>
      </div>

    </div>
  </ul>
</div>

<script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
        $('input[type=radio][name="participant[rating]"]').change(function() {
            console.log("Saving...");
            $('#participant-form').submit();
        });
    });
</script>